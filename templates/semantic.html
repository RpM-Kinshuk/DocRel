{% extends 'base.html' %}

{% block title %}Semantic Analysis{% endblock %}

{% block content %}
    <h1>Semantic Analysis</h1>
    <form id="semantic-form">
        <div class="form-group">
            <label for="query">Enter a query:</label>
            <input type="text" id="query" name="query" required>
        </div>
        
        <div class="form-group">
            <label for="top_n">Enter the number of results needed:</label>
            <input type="number" id="top_n" name="top_n" required value="5">
        </div>

        <div class="form-group">
            <label for="model">Select Model:</label>
            <select id="model" name="model" required>
                <option value="model1">Model 1</option>
                <option value="model2">Model 2</option>
                <option value="model3">Model 3</option>
            </select>
        </div>

        <button type="submit" class="btn-submit">Analyze</button>
    </form>

    <div id="semantic-results"></div>

    <script>
        document.getElementById('semantic-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const query = formData.get('query');
            const model = formData.get('model');

            fetch('/semantic', {
                method: 'POST',
                body: new URLSearchParams(formData)
            })
            .then(response => response.json())
            .then(data => {
                const resultsContainer = document.getElementById('semantic-results');
                resultsContainer.innerHTML = ''; // Clear previous results
                const results = data.results;
                if (results.length > 0) {
                    const ul = document.createElement('ul');
                    results.forEach(result => {
                        const li = document.createElement('li');
                        li.textContent = result;
                        ul.appendChild(li);
                    });
                    resultsContainer.appendChild(ul);
                } else {
                    resultsContainer.textContent = 'No results found';
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
{% endblock %}
